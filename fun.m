function N = fun(ks,yt,zita,ndim,mnode)
% 四节点四边形的形函数
N = zeros(mnode,1);
if ndim == 2
    if mnode == 4
        N = zeros(4,1);
        N(1) = (1-ks)*(1-yt)/4;
        N(2) = (1+ks)*(1-yt)/4;
        N(3) = (1+ks)*(1+yt)/4;
        N(4) = (1-ks)*(1+yt)/4;
    elseif mnode == 8
        N(1) = (1/4).*(1+(-1).*ks).*(1+(-1).*yt).*((-1)+(-1).*ks+(-1).*yt);
        N(2) = (1/4).*(1+ks).*(1+(-1).*yt).*((-1)+ks+(-1).*yt);
        N(3) = (1/4).*(1+ks).*(1+yt).*((-1)+ks+yt);        
        N(4) = (1/4).*(1+(-1).*ks).*(1+yt).*((-1)+(-1).*ks+yt);        
        N(5) = (1/2).*(1+(-1).*ks.^2).*(1+(-1).*yt);        
        N(6) = (1/2).*(1+ks).*(1+(-1).*yt.^2);        
        N(7) = (1/2).*(1+(-1).*ks.^2).*(1+yt);        
        N(8) = (1/2).*(1+(-1).*ks).*(1+(-1).*yt.^2);
    end
elseif ndim == 3
    if mnode == 8
        N(1) = (1/8).*(1+ks).*(1+(-1).*yt).*(1+(-1).*zita);
        N(2) = (1/8).*(1+ks).*(1+yt).*(1+(-1).*zita);
        N(3) = (1/8).*(1+(-1).*ks).*(1+yt).*(1+(-1).*zita);
        N(4) = (1/8).*(1+(-1).*ks).*(1+(-1).*yt).*(1+(-1).*zita);
        N(5) = (1/8).*(1+ks).*(1+(-1).*yt).*(1+zita);
        N(6) = (1/8).*(1+ks).*(1+yt).*(1+zita);
        N(7) = (1/8).*(1+(-1).*ks).*(1+yt).*(1+zita);
        N(8) = (1/8).*(1+(-1).*ks).*(1+(-1).*yt).*(1+zita);

    elseif mnode == 20
        N(1) = (1/8).*(1+ks).*(1+(-1).*yt).*(1+(-1).*zita).*((-2)+ks+(-1).*yt+( ...
            -1).*zita);
        N(2) = (1/8).*(1+ks).*(1+yt).*(1+(-1).*zita).*((-2)+ks+yt+(-1).*zita);      
        N(3) = (1/8).*(1+(-1).*ks).*(1+yt).*(1+(-1).*zita).*((-2)+(-1).*ks+yt+( ...
            -1).*zita);       
        N(4) = (1/8).*(1+(-1).*ks).*(1+(-1).*yt).*(1+(-1).*zita).*((-2)+(-1).*ks+ ...
            (-1).*yt+(-1).*zita);       
        N(5) = (1/8).*(1+ks).*(1+(-1).*yt).*(1+zita).*((-2)+ks+(-1).*yt+zita);        
        N(6) = (1/8).*(1+ks).*(1+yt).*(1+zita).*((-2)+ks+yt+zita);        
        N(7) = (1/8).*(1+(-1).*ks).*(1+yt).*(1+zita).*((-2)+(-1).*ks+yt+zita);        
        N(8) = (1/8).*(1+(-1).*ks).*(1+(-1).*yt).*(1+zita).*((-2)+(-1).*ks+(-1).* ...
            yt+zita);        
        N(9) = (1/4).*(1+ks).*(1+(-1).*yt.^2).*(1+(-1).*zita);        
        N(10) = (1/4).*(1+(-1).*ks.^2).*(1+yt).*(1+(-1).*zita);       
        N(11) = (1/4).*(1+(-1).*ks).*(1+(-1).*yt.^2).*(1+(-1).*zita);        
        N(12) = (1/4).*(1+(-1).*ks.^2).*(1+(-1).*yt).*(1+(-1).*zita);        
        N(13) = (1/4).*(1+ks).*(1+(-1).*yt.^2).*(1+zita);        
        N(14) = (1/4).*(1+(-1).*ks.^2).*(1+yt).*(1+zita);        
        N(15) = (1/4).*(1+(-1).*ks).*(1+(-1).*yt.^2).*(1+zita);        
        N(16) = (1/4).*(1+(-1).*ks.^2).*(1+(-1).*yt).*(1+zita);        
        N(17) = (1/4).*(1+ks).*(1+(-1).*yt).*(1+(-1).*zita.^2);        
        N(18) = (1/4).*(1+ks).*(1+yt).*(1+(-1).*zita.^2);       
        N(19) = (1/4).*(1+(-1).*ks).*(1+yt).*(1+(-1).*zita.^2);        
        N(20) = (1/4).*(1+(-1).*ks).*(1+(-1).*yt).*(1+(-1).*zita.^2);
    elseif mnode == 27
        N(1) =  (1/8).*((-1)+ks).*ks.*((-1)+yt).*yt.*((-1)+zita).*zita;

        N(2) =  (1/4).*(1+(-1).*ks.^2).*((-1)+yt).*yt.*((-1)+zita).*zita;

        N(3) =  (1/8).*ks.*(1+ks).*((-1)+yt).*yt.*((-1)+zita).*zita;

        N(4) =  (1/4).*((-1)+ks).*ks.*(1+(-1).*yt.^2).*((-1)+zita).*zita;

        N(5) =  (1/2).*(1+(-1).*ks.^2).*(1+(-1).*yt.^2).*((-1)+zita).*zita;

        N(6) =  (1/4).*ks.*(1+ks).*(1+(-1).*yt.^2).*((-1)+zita).*zita;

        N(7) =  (1/8).*((-1)+ks).*ks.*yt.*(1+yt).*((-1)+zita).*zita;

        N(8) =  (1/4).*(1+(-1).*ks.^2).*yt.*(1+yt).*((-1)+zita).*zita;

        N(9) =  (1/8).*ks.*(1+ks).*yt.*(1+yt).*((-1)+zita).*zita;

        N(10) =  (1/4).*((-1)+ks).*ks.*((-1)+yt).*yt.*(1+(-1).*zita.^2);

        N(11) =  (1/2).*(1+(-1).*ks.^2).*((-1)+yt).*yt.*(1+(-1).*zita.^2);

        N(12) =  (1/4).*ks.*(1+ks).*((-1)+yt).*yt.*(1+(-1).*zita.^2);

        N(13) =  (1/2).*((-1)+ks).*ks.*(1+(-1).*yt.^2).*(1+(-1).*zita.^2);

        N(14) =  (1+(-1).*ks.^2).*(1+(-1).*yt.^2).*(1+(-1).*zita.^2);

        N(15) =  (1/2).*ks.*(1+ks).*(1+(-1).*yt.^2).*(1+(-1).*zita.^2);

        N(16) =  (1/4).*((-1)+ks).*ks.*yt.*(1+yt).*(1+(-1).*zita.^2);

        N(17) =  (1/2).*(1+(-1).*ks.^2).*yt.*(1+yt).*(1+(-1).*zita.^2);

        N(18) =  (1/4).*ks.*(1+ks).*yt.*(1+yt).*(1+(-1).*zita.^2);

        N(19) =  (1/8).*((-1)+ks).*ks.*((-1)+yt).*yt.*zita.*(1+zita);

        N(20) =  (1/4).*(1+(-1).*ks.^2).*((-1)+yt).*yt.*zita.*(1+zita);

        N(21) =  (1/8).*ks.*(1+ks).*((-1)+yt).*yt.*zita.*(1+zita);

        N(22) =  (1/4).*((-1)+ks).*ks.*(1+(-1).*yt.^2).*zita.*(1+zita);

        N(23) =  (1/2).*(1+(-1).*ks.^2).*(1+(-1).*yt.^2).*zita.*(1+zita);

        N(24) =  (1/4).*ks.*(1+ks).*(1+(-1).*yt.^2).*zita.*(1+zita);

        N(25) =  (1/8).*((-1)+ks).*ks.*yt.*(1+yt).*zita.*(1+zita);

        N(26) =  (1/4).*(1+(-1).*ks.^2).*yt.*(1+yt).*zita.*(1+zita);

        N(27) =  (1/8).*ks.*(1+ks).*yt.*(1+yt).*zita.*(1+zita);

    end
end